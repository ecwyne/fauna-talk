import { themes, Image, Split } from 'mdx-deck';
import Highlighter from 'react-syntax-highlighter';
import prismStyle from 'react-syntax-highlighter/dist/esm/styles/prism/vs-dark';

export const theme = {
    ...themes.default,
    components: {
        pre: themes.prism.components.pre,
        code: props => {
            return themes.prism.components.code({
                ...props,
                style: prismStyle,
            });
        },
    },
};

import avatar from './images/avatar.jpeg';

# :wave: Hello World

<img src={avatar} />
<br />
<div>Eric Wyne</div>
<div>@ecwyne</div>
<img src="https://www.commissionbuddies.com/wp-content/uploads/2018/04/CB_Logos_FINAL_white_30px.png" />

<br />

---

# Company Backgorund

-   :date: Founded 2017
-   :book: Origin Story
-   :credit_card: Processing Referral Network

https://bit.ly/commbuds-nextjs

---

# Technical Requirements

-   :zap: Rapid Development
-   :woman_in_lotus_position: Flexible Architecture
-   :chart_with_upwards_trend: Scalable
-   :lock: Secure
-   :heavy_dollar_sign: Transactional

---

# Meteor.js

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :x: Scalable
-   :white_check_mark: Secure
-   :x: Transactional

---

# ~~Meteor.js~~

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :x: Scalable
-   :white_check_mark: Secure
-   :x: Transactional

---

# Gatsby/Netlify Functions

-   :warning: Rapid Development
-   :warning: Flexible Architecture
-   :white_check_mark: Scalable
-   :grey_question: Secure
-   :grey_question: Transactional

---

# ~~Gatsby/Netlify Functions~~

-   :warning: Rapid Development
-   :warning: Flexible Architecture
-   :white_check_mark: Scalable
-   :grey_question: Secure
-   :grey_question: Transactional

---

# Next.js + Now.sh (circa 2017)

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :white_check_mark: Scalable
-   :grey_question: Secure
-   :grey_question: Transactional

---

# :tada: Next.js (v9.0) :tada:

-   :rocket: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :white_check_mark: Scalable
-   :grey_question: Secure
-   :grey_question: Transactional

---

# What about data?

-   :grey_question: Secure
-   :grey_question: Transactional

---

import tree from './images/tree.png';

<div style={{display: 'flex', justifyContent: 'center', alignItems: 'center'}}>


<div>
    <img src={tree} style={{ width: '100%', height: '100%' }} />
</div>

<div>


# An example...

Accruing commissions

-   Programatically climb account hierarch
-   Data consistency is vital
-   ACID compliant transactions

</div>


</div>


---

# MongoDB

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :warning: Scalable
-   :warning: Secure
-   :x: Transactional

---

# DynamoDB

-   :x: Rapid Development
-   :warning: Flexible Architecture
-   :white_check_mark: Scalable
-   :warning: Secure
-   :x: Transactional (circa 2017)

---

# Firebase

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :white_check_mark: Scalable
-   :white_check_mark: Secure
-   :x: Transactional

---

# FaunaDB

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :white_check_mark: Scalable
-   :white_check_mark: Secure
-   :white_check_mark: Transactional

---

# :tada: FaunaDB :tada:

-   :white_check_mark: Rapid Development
-   :white_check_mark: Flexible Architecture
-   :white_check_mark: Scalable
-   :white_check_mark: Secure
-   :white_check_mark: Transactional

---

# Additionally...

-   :cloud: Built for serverless
-   :clock2: Built-in temporality
-   :earth_americas: Hands-free geo-distribution
-   :atom_symbol: GraphQL API
-   :muscle: Powerful Query Language (FQL)
-   :zap: Real-time streaming (in beta)

---

# Next.js + FaunaDB :rocket: :rocket: :rocket:

---

### FQL vs GraphQL

<iframe
    width="560"
    height="315"
    src="https://www.youtube.com/embed/KlUPiQaTp0I"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
></iframe>

---

import signup from './images/signup.png';

#### Visit https://dashboard.fauna.com

<Image src={signup} style={{ width: '90%', backgroundSize: 'contain' }}></Image>

---

import newdb from './images/newdb.png';

#### Create a database

<Image src={newdb} style={{ height: '50%', backgroundSize: 'contain' }}></Image>

---

import dbhome from './images/dbhome.png';

<Image src={dbhome} style={{ width: '90%', backgroundSize: 'contain' }}></Image>

---

import newcollection from './images/newcollection.png';

#### Create a collection

<Image
    src={newcollection}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

import newdocument from './images/newdocument.png';

#### Create a user document

<Image
    src={newdocument}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

import collectionlist from './images/collectionlist.png';

<Image
    src={collectionlist}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

# FQL

```typescript
import { query as q } from 'faunadb';

const data = { handle: 'ecwyne' };

const usersCollection = q.Collection('users');
const createUserQuery = q.Create(usersCollection, { data });
```

import drivers from './images/drivers.png';

<Image
    src={drivers}
    style={{ height: '25%', backgroundSize: 'contain' }}
></Image>

---

### [https://docs.fauna.com/fauna/current/api/fql/cheat_sheet](https://docs.fauna.com/fauna/current/api/fql/cheat_sheet)

import cheatsheet from './images/cheatsheet.png';

<Image
    src={cheatsheet}
    style={{ width: '90%', backgroundSize: 'contain' }}
></Image>

---

import updatepassword from './images/updatepassword.png';

<Image
    src={updatepassword}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

# FaunaDB Client

```typescript
import { Client } from 'faunadb';

const client = new Client({ secret: '...' });

await client.query(query).then(...)

```

---

```typescript
import { Client, query as q } from 'faunadb';

const handler = async (req, res) => {
    const { handle, password } = req.body;
    const client = new Client({ secret: '???' });
};
```

#### pages/api/login.js

---

import createserverkey from './images/createserverkey.png';

<Image
    src={createserverkey}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

import serverkey from './images/serverkey.png';

<Image
    src={serverkey}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

```typescript
import { Client, query as q } from 'faunadb';

const handler = async (req, res) => {
    const { handle, password } = req.body;
    const client = new Client({
        secret: 'fnAD4lN6LsACDZCBTVS5LkxWHMSpSTAuDLTImMe7',
    });

    // TODO Match user by handle
    // TODO Use password to get user secret
};
```

#### pages/api/login.js

---

import newindex from './images/newindex.png';

<Image
    src={newindex}
    style={{ height: '75%', width: '90%', backgroundSize: 'contain' }}
></Image>

---

```typescript
import { Client, query as q } from 'faunadb';

const handler = async (req, res) => {
    const { handle, password } = req.body;
    const client = new Client({
        secret: 'fnAD4lN6LsACDZCBTVS5LkxWHMSpSTAuDLTImMe7',
    });
    // Match user by handle
    const matchedUser = q.Match(q.Index('userByHandle'), handle);
    // TODO use password to get user secret
};
```

#### pages/api/login.js

---

```typescript
const handler = async (req, res) => {
    const { handle, password } = req.body;
    const client = new Client({
        secret: 'fnAD4lN6LsACDZCBTVS5LkxWHMSpSTAuDLTImMe7',
    });
    // Match user by handle
    const matchedUser = q.Match(q.Index('userByHandle'), handle);
    // Use password to get user secret
    client
        .query(q.Login(matchedUser, { password }))
        .then(({ secret }) => res.send(secret));
};
```

#### pages/api/login/login.js

---

# Links

Fauna Dashboard: https://dashboard.fauna.com

Fauna Docs: https://docs.fauna.com

Commission Buddies: https://commissionbuddies.com

Join Commission Buddies: https://bit.ly/commbuds-nextjs
